## Лабораторная работа №4. Интерполяция

На основе численности населения США с 1920 до 2015 года с помощью интерполяций Ньютона и глобальной интеполяции сплайном экстраполируется значение население США на 2022 год и сравнивается с настоящим значением.

В данной лабораторной работе используются следующие данные населения США:

|Год |Население |
| --- | --- |
|1910|92 228 496|
|1920|106 021 537|
|1930|123 202 624|
|1940|132 164 569|
|1950|151 325 798|
|1960|179 323 175|
|1970|203 211 926|
|1980|226 545 805|
|1990|248 709 873|
|2000|281 421 906|
|2010|308 745 538|
|2015|324 607 776|

На 2022 год в США проживают 337 168 104 человек.

### Интерполяция Ньютона

Найдём коэффициенты полинома Ньютона:

| №   |$x$   |    $b_0$   |   $b_1$  |   $b_2$   |    $b_3$    |    $b_4$   |   $b_5$  |   $b_6$  |   $b_7$  |   $b_8$  |     $b_9$    |    $b_10$     |   $b_11$   |
| --- | ---  |    ---     |   ---    |    ---    |      ---    |     ---    |   ---    |    ---   |    ---   |   ---    |      ---     |      ---      |     ---    |
|0   |1910  | 92228496.0  |1379304.1 | 16940.230 |-1934.531333 | 125.106725 |-4.150598 | 0.080565 |-0.000756 |-0.000008 | 5.099328e-07 |-1.430668e-08  |3.689161e-10|
|1   |1920  |106021537.0  |1718108.7 |-41095.710 | 3069.737667 | -82.423175 | 0.683327 | 0.027611 |-0.001362 | 0.000038 |-9.207357e-07 | 2.442951e-08  |         NaN|
|2   |1930  |123202624.0  | 896194.5 | 50996.420 | -227.189333 | -48.256825 | 2.340014 |-0.067705 | 0.001705 |-0.000045 | 1.400068e-06 |          NaN  |         NaN|
|3   |1940  |132164569.0  |1916122.9 | 44180.740 |-2157.462333 |  68.743867 |-1.722268 | 0.051623 |-0.001858 | 0.000074 |          NaN |          NaN  |         NaN|
|4   |1950  |151325798.0  |2799737.7 |-20543.130 |  592.292333 | -17.369554 | 1.375117 |-0.078456 | 0.003727 |      NaN |          NaN |          NaN  |         NaN|
|5   |1960  |179323175.0  |2388875.1 | -2774.360 | -102.489833 |  51.386312 |-3.332238 | 0.163792 |      NaN |      NaN |          NaN |          NaN  |         NaN|
|6   |1970  |203211926.0  |2333387.9 | -5849.055 | 1952.962667 |-115.225592 | 5.676314 |      NaN |      NaN |      NaN |          NaN |          NaN  |         NaN|
|7   |1980  |226545805.0  |2216406.8 | 52739.825 |-2656.061000 | 140.208560 |      NaN |      NaN |      NaN |      NaN |          NaN |          NaN  |         NaN|
|8   |1990  |248709873.0  |3271203.3 |-26942.005 | 2251.238600 |        NaN |      NaN |      NaN |      NaN |      NaN |          NaN |          NaN  |         NaN|
|9   |2000  |281421906.0  |2732363.2 | 29338.960 |         NaN |        NaN |      NaN |      NaN |      NaN |      NaN |          NaN |          NaN  |         NaN|
|10  |2010  |308745538.0  |3172447.6 |       NaN |         NaN |        NaN |      NaN |      NaN |      NaN |      NaN |          NaN |          NaN  |         NaN|
|11  |2015  |324607776.0  |      NaN |       NaN |         NaN |        NaN |      NaN |      NaN |      NaN |      NaN |          NaN |          NaN  |         NaN|

Используя нижнюю диагональ в качестве коэффициентов (т.к. экстраполируемое значение находится ближе к этой стороне), построим полином Ньютона и найдём значение населения США в 2022: 805 870 552 человек! Это явно не согласуется с реальным значением.

### Интерполяция сплайном

Используем кубический сплайн вида 
$$S(x) = a_i + b_i (x - x_i) + \frac{c_i}{2} (x - x_i)^2 +  \frac{d_i}{6} (x - x_i)^3$$ 

Зададим граничные условия как 
$$f''(1910) = f''(2015) = 0$$

Нахождение коэффициентов сплайна осуществляется через коэффициенты $c_i$, являющимися решениями уравнения $Mx = f$, где

$$M = \left(
    \begin{matrix}
        C_1 & B_1 & 0 & 0 & \dots & 0 & 0\\
        A_2 & C_2 & B_2 & 0 & \dots & 0 & 0\\
        0 & A_3 & C_3 & B_3 & \dots & 0 & 0\\
        \dots & \dots & \dots & \dots & \dots & \dots & \dots\\
        \dots & \dots & \dots & \dots & \dots & \dots & B_{n - 1}\\
        C_1 & B_1 & 0 & 0 & \dots & A_n & C_n\\
    \end{matrix}
    \right), где \: n = 8
$$

Граничные условия выражаются как

$$
c_0 = c_{12} = 0
$$

$$
\begin{cases}
    A_i = x_i - x_{i - 1}, i = \overline{2\dots n}, \\
    B_i = x_{i + 1} - x_{i}, i = \overline{1\dots n - 1}, \\
    C_i = 2\cdot\left(x_{i + 1} - x_{i - 1}\right), i = \overline{1\dots n}
\end{cases}
$$

$$
F_i = 6 \cdot \left(
    \frac{y_{i + 1} - y_i}{x_{i + 1} - x_i} - 
    \frac{y_{i} - y_{i - 1}}{x_{i} - x_{i - 1}}
    \right)
$$

В результате интерполяции сплайном экстраполирем население США: 345 999 606 человек, что неплохо сходится с настоящим значением 337 168 104 человек.

### Результаты

Описание всех результатов, изложенных выше, также можно найти в файле `report.txt`.
